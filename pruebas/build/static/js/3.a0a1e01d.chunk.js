"use strict";(self.webpackChunkbdmdm=self.webpackChunkbdmdm||[]).push([[3],{9003:(e,a,n)=>{n.r(a),n.d(a,{default:()=>c});var t=n(5043),s=n(2297),i=n(6351),o=(n(6676),n(9596)),r=n(579);const c=function(){const[e,a]=(0,t.useState)({correo:"",curp:""}),[n,c]=(0,t.useState)([{tipoEstudio:"",cantidadImagenes:0,esDonacion:!1,observaciones:""}]),[d,l]=(0,t.useState)([]),u=["Radiografia","Tomografia Computarizada","Resonancia Magnetica","Ultrasonido","Mastografia","Angiografia","Medicina Nuclear","Fluoroscopia"],h=e=>{const{name:n,value:t}=e.target;a((e=>({...e,[n]:t})))},p=(e,a)=>{const{name:n,value:t,type:s,checked:i}=a.target;c((a=>{const o=[...a];return o[e]={...o[e],[n]:"checkbox"===s?i:"cantidadImagenes"===n?parseInt(t,10)||0:t},o}))},m=()=>{const e=new Date;let a=0;for(;a<5;)e.setDate(e.getDate()+1),0!==e.getDay()&&6!==e.getDay()&&a++;return e.toISOString()},x=e=>{if(!e)return"-";const a=new Date(e);return`${String(a.getDate()).padStart(2,"0")}-${String(a.getMonth()+1).padStart(2,"0")}-${a.getFullYear()}`},g=e=>/^[A-Z]{4}\d{6}[HM][A-Z]{5}[A-Z0-9]{2}$/.test(e);return(0,r.jsxs)("div",{children:[(0,r.jsx)(s.A,{}),(0,r.jsxs)("div",{className:".registro-container",children:[(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),!g(e.curp))return void alert("Por favor, ingresa un CURP v\xe1lido.");const s=Math.floor(1e11*Math.random()).toString().padStart(12,"0"),i=(new Date).toISOString(),r=n.map((e=>({tipoEstudio:e.tipoEstudio,cantidadImagenes:parseInt(e.cantidadImagenes,10),esDonacion:e.esDonacion,observaciones:e.observaciones,fechaDevolucion:e.esDonacion?"":m()}))),d=n.map((e=>e.tipoEstudio)).join(", "),u=n.reduce(((e,a)=>e+a.cantidadImagenes),0),h={folio:s,fechaRecepcion:i,...e,estudios:d,cantidadTotalImagenes:u,detallesEstudios:r};try{if(!(await fetch(`${o.C}/api/estudios`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok)throw new Error("Error al guardar el estudio");l((e=>[...e,h])),a({correo:"",curp:""}),c([{tipoEstudio:"",cantidadImagenes:0,esDonacion:!1,observaciones:""}])}catch(p){console.error("Error:",p)}},children:[(0,r.jsx)("h2",{children:"Datos de la Persona"}),(0,r.jsxs)("label",{children:["Correo:",(0,r.jsx)("input",{type:"email",name:"correo",value:e.correo,onChange:h,required:!0,className:"input-field-R"})]}),(0,r.jsxs)("label",{children:["CURP:",(0,r.jsx)("input",{type:"text",name:"curp",value:e.curp,onChange:h,required:!0,className:"input-field-R",maxLength:18})]}),(0,r.jsx)("h2",{children:"Datos de los Estudios"}),n.map(((e,a)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{children:["Tipo de Estudio:",(0,r.jsxs)("select",{name:"tipoEstudio",value:e.tipoEstudio,onChange:e=>p(a,e),required:!0,className:"input-field-R",children:[(0,r.jsx)("option",{value:"",children:"Seleccionar"}),u.map(((e,a)=>(0,r.jsx)("option",{value:e,children:e},a)))]})]}),(0,r.jsxs)("label",{children:["Cantidad de Im\xe1genes:",(0,r.jsx)("input",{type:"number",name:"cantidadImagenes",value:e.cantidadImagenes,onChange:e=>p(a,e),min:"1",required:!0,className:"input-field-R"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{children:["Donaci\xf3n:",(0,r.jsx)("input",{type:"checkbox",name:"esDonacion",checked:n.esDonacion,onChange:e=>p(a,e)})]}),(0,r.jsxs)("label",{children:["Observaciones:",(0,r.jsx)("textarea",{name:"observaciones",value:n.observaciones,onChange:e=>p(a,e),className:"input-field-R"})]})]})]},a))),(0,r.jsx)("button",{type:"button",onClick:()=>{c((e=>[...e,{tipoEstudio:"",cantidadImagenes:0,esDonacion:!1,observaciones:""}]))},className:"add-study-button-R",children:"Agregar otro estudio"}),(0,r.jsx)("button",{type:"submit",children:"Guardar"})]})}),d.length>0&&(0,r.jsxs)("div",{className:"table-container-R",children:[(0,r.jsx)("h2",{children:"Registros Guardados"}),(0,r.jsxs)("table",{className:"data-table-R",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Folio"}),(0,r.jsx)("th",{children:"Fecha de Recepci\xf3n"}),(0,r.jsx)("th",{children:"Fecha de Devoluci\xf3n"}),(0,r.jsx)("th",{children:"CURP"})]})}),(0,r.jsx)("tbody",{children:d.map(((e,a)=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.folio}),(0,r.jsx)("td",{children:x(e.fechaRecepcion)}),(0,r.jsx)("td",{children:x(e.fechaDevolucion)}),(0,r.jsx)("td",{children:e.curp})]},a)))})]})]})]}),(0,r.jsx)("div",{className:"next-module"}),(0,r.jsx)(i.A,{})]})}}}]);
//# sourceMappingURL=3.a0a1e01d.chunk.js.map